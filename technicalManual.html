<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Store Calls System - Manuals</title>
        <meta name="viewport" content="width=device-width" />
        <link rel="stylesheet" type="text/css" href="css/foundation.css">
        <link rel="stylesheet" type="text/css" href="css/app.css">
        <script src="js/modernizr.js"></script>
    </head>
    <body>
        <nav class="top-bar" data-topbar role="navigation">
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Store Calls Manuals</a></h1>
            </li>
             <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
            <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
          </ul>

          <section class="top-bar-section">
            <!-- Left Nav Section -->
            <ul class="left">
                <li><a href="userManual.html">User Manual</a></li>
                <li><a href="technicalManual.html">Technical Manual</a></li>
            </ul>
          </section>
        </nav>
        <div data-magellan-expedition="fixed">
          <dl class="sub-nav">
            <dd data-magellan-arrival="contents"><a href="#contents">Contents</a></dd>
            <dd data-magellan-arrival="overview"><a href="#overview">Overview</a></dd>
            <dd data-magellan-arrival="architecture"><a href="#architecture">Architecture</a></dd>
            <dd data-magellan-arrival="database"><a href="#database">Database design</a></dd>
            <dd data-magellan-arrival="high"><a href="#high">High level design</a></dd>
            <dd data-magellan-arrival="user_interface"><a href="#user_interface">User Interface design</a></dd>
            <dd data-magellan-arrival="validation"><a href="#validation">Validation</a></dd>
            <dd data-magellan-arrival="authentication"><a href="#authentication">Authorization</a></dd>
            <dd data-magellan-arrival="implementation"><a href="#implementation">Implementation</a></dd>
            <dd data-magellan-arrival="discussion"><a href="#discussion">Discussion</a></dd>
            <dd data-magellan-arrival="references"><a href="#references">References</a></dd>
          </dl>
        </div>
         <section class="large-12 small-12 columns">
          <h3 class="cheaders">Technical Manual</h3>
          <hr class="chr">
          <div id="contents">
            <a name="contents"></a>
            <h4 data-magellan-destination="contents" class="cheaders"> Contents:</h4>
            <p>The technical manual has the following contents: </p>
            <ul class="customList">
              <li><a href="#overview">1. Overview</a></li>
              <li><a href="#architecture">2. Architecture</a></li>
              <li><a href="#database">3. Database design</a></li>
              <li><a href="#high">4. High level design</a></li>
              <li><a href="#user_interface">5. User interface design</a></li>
              <li><a href="#validation">6. Validation</a></li>
              <li><a href="#authentication">7. Authorization</a></li>
              <li><a href="#implementation">8. Implementation</a></li>
              <li><a href="#discussion">9. Discussion</a></li>
              <li><a href="#references">10. References</a></li>
            </ul>
          </div>
          <div id="overview">
            <a id="overview"></a>
            <h4 data-magellan-destination="overview" class="cheaders">1. Overview</h4>
            <hr class="chr">
            <p>The technical manual document outlines the technical details of architecture, design and implementation of the system. The documents presents a high level design consisting of the main functionality the program does and afterwards a detailed design is included in order to demostrate what is intended to be achieved with the implementation.</p>
          </div>
          <div id="architecture">
            <a id="architecture"></a>
            <h4 data-magellan-destination="architecture" class="cheaders">2. Architecture</h4>
            <hr class="chr">
            <p>The system is build using ASP.NET MVC and a SQL Express Database. The Model-View-Controller (MVC) architectural pattern separates an application into three main components: models, views and controllers. The main advantages of using an MVC pattern are:</p>
            <ul class="customList">
              <li>It makes easier to manage a complex application.</li>
              <li>Enables full control over the rendered HTML.</li>
              <li>The application follows a natural cycle: when a user takes an action, the data models changes and delivers an updated view to the user.</li>
              <li>ASP.NET MVC helps the developer to produce clean, standard markup using HTML helper methods.</li>
              <li>Given the fact that the application is separated in layers, it makes easier to test each component individually.</li>
              <li>Powerful routing system (more similar to RestFul). For example, instead of URLs like this: <code>/App_v2/User/Page.aspx?action=show%20prop&prop_id=82742</code> uses URLs like: <code>/to-rent/chicago/2303-silver-street</code>.</li>
            </ul>
            <br />
            <p>The next diagram shows how the application is separated in layers, the comunication among components and the contents of each one.</p>
            <a id="image1"></a>
            <img src="images/architecture.png" alt="architecture"><br />
            <span class="imgNote">[Image 1]. Architecture of the system.</span>
            <blockquote>References: 
            <ul>
              <li>Msdn.microsoft.com, (2014). ASP.NET MVC Overview. [online] Available at: http://msdn.microsoft.com/en-us/library/dd381412%28v=vs.108%29.aspx </li>
              <li>forms, B. (2014). Biggest advantage to using ASP.Net MVC vs web forms. [online] Stackoverflow.com. Available at: http://stackoverflow.com/questions/102558/biggest-advantage-to-using-asp-net-mvc-vs-web-forms</li>
              <li>Pro ASP.NET MVC 4 (Professional Apress) 4th. Apress Berkely, CA, USA ©2013. ISBN:1430242361 9781430242369</li>
            </ul>
            <blockquote>
          </div>
          <div id="database">
            <a id="database"></a>
            <h4 data-magellan-destination="database" class="cheaders">3. Database design</h4>
            <hr class="chr">
            <div class="panel callout radius">
              <p>Two databases are used in the system, one is the default-system database used for users and roles; the other was designed specifically for the system. The next diagram shows the design of the databases.</p>
            </div>
            <div class="small-12 large-6 panel columns">
              <img src="images/custom_database.png" alt="custom database"><br />
              <span class="imgNote">Entity relationship.</span>
            </div>
            <div class="small-12 large-6 panel columns">
              <p>The structure of the database was defined in the models (See <a href="#image1">Image 1</a>), in order to use the Entity Framework Data Model for ASP.NET MVC, the class can be found at <span class="imgNote">"/DAL/CallContext.cs", the script to generate the tables can be found at: <span class="imgNote"> "Migrations/201411142345057_InitialCreate.cs"</span>. CallContext.cs:</p>
              <pre>
public DbSet<Call> Calls { get; set; }
public DbSet<Employee> Employees { get; set; }
public DbSet<Person> Persons { get; set; }
public DbSet<Category> Categories { get; set; }

static CallContext()
{
    Database.SetInitializer<CallContext>(null);
}
              </pre>
              <span class="imgNote">Entity Framework - migrations.</span>
            </div>
            <div class="small-12 large-12 columns">
            <blockquote>References:
              <ul>
                <li>The Official Microsoft ASP.NET Site, (2014). Creating an Entity Framework Data Model. [online] Available at: http://www.asp.net/mvc/overview/older-versions/getting-started-with-ef-5-using-mvc-4/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application</li> 
                <li>The Official Microsoft ASP.NET Site, (2014). Part 4: Models and Data Access. [online] Available at: http://www.asp.net/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-4</li> 
              </ul>
            </blockquote>
            </div>
            <div class="small-12 large-6 panel columns">
              <img src="images/userroles.jpg" alt="custom database"><br />
              <span class="imgNote">Entity relationship.</span>
            </div>
            <div class="small-12 large-6 panel columns">
              
<pre>
      Basically, SimpleMembershipInitializer is a class extending ActionFilterAttribute. The latter is in order to insert the code into “ASP.NET MVC execution life cycle” (Ciliberti, 275). This class contains an overriding method called <a class="command">OnActionExecuting</a> and <a class="command">LazyInitializer.EnsureInitialized </a>, which inside the former method, is invoked to verify and guarantee that initializeSimpleMemberShipAttribute has been executed just once per application (Ciliberti, 275).
      <ol>
          <li>Database.SetInitializer<UsersContext>(null); this is to establish initialization scheme of a database for the UserContext class.</li>
          <li>context.Database.Exists() is located inside try/catch block which is to ensure the database has been created.</li>
          <li>WebSecurity.InitializeDatabaseConnection: it is a method is called at a start of the application. The purpose of this method as the following:</li>
          <ul>
              <li>Tests the membership database is available. In case of it isn’t available, membership tables are created.(Microsoft MSDN, 2014)</li>
              <li>“Opens a connection to the user profile table and establishes a database relationship between the membership data and the user profile data” (Microsoft MSDN, 2014).</li>
          </ul>
        </ol>
            Parameters of WebSecurity method are
                <table>
                    <tr>
                        <th>Parameter name</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>DefaultConnection</td>
                        <td>String</td>
                        <td>This refers to the connection string containing “user information”. DefaultConnection is the name of connectionstring created in WebConfig as shown in the below picture
                        </td>
                    </tr>
                    <tr>
                        <td>UserProfile</td>
                        <td>String</td>
                        <td>Database table name involving user information</td>
                    </tr>
                    <tr>
                        <td>UserId</td>
                        <td>String</td>
                        <td>This is a column name in database containing user IDs which are defined as an Integer.</td>
                    </tr>
                    <tr>
                        <td>UserName</td>
                        <td>String</td>
                        <td>This is the column name in database containing user Names. The purpose of it is to verify “user profile data’’ matches “membership data account"</td>
                    </tr>
                    <tr>
                        <td>autoCreateTables: true</td>
                        <td>Boolean</td>
                        <td>This is in order to create a membership tables. In case of it is not exist.</td>
                    </tr>
                </table>
            <img id="addRef" src="images/ConnectionString.png" alt="connectionString"></img>
            <br />
    Finally, this class contains also an OnActionExecuting method which is executed each time the controller, which is associated with the initializeSimpleMemberShipAttribute, is invoked (Ciliberti, 275)
</ul>
              </pre>
              <span class="imgNote">SimpleMembershipInitializer .</span>
            </div>
            <div class="small-12 large-12 columns">
            <blockquote>References:
              <ul>
                <li>Ciliberti J. ASP.NET MVC 4 Recipes. Apress</li> 
                <li>Microsoft MSDN, (2014). Initialize Database connection. [online] Available at: http://msdn.microsoft.com/en-us/library/webmatrix.webdata.websecurity.initializedatabaseconnection(v=vs.111).aspx</li> 
                <li>Youtube.com, (2014).Simple Membership in ASP NET MVC 5 Web Applications [online] Available at: https://www.youtube.com/watch?v=BsKcVbsMn6w</li>
              </ul>
            </blockquote>
            </div>
          </div>
          <div id="high" class="small-12 large-12 columns">
            <a id="high"></a>
            <h4 data-magellan-destination="high" class="cheaders">4. High level design</h4>
            <hr class="chr">
            <p>The user can perform different actions in the system. The following diagrams shows how the diagram communicates among its components when the user sends a request to the system.</p>
            <section class="small-12 large-12 columns">
              <div class="small-12 large-3 panel columns">
                <p>The diagram from the right shows the interaction among the components when a user register on the system (<a id="register_design_show">show</a> | <a id="register_design_hide">hide</a>).</p>
              </div>
              <div id="register_design" class="small-12 large-9 panel columns">
                <p><span class="important">Register. </span></p>
                <img src="images/register_design.png" alt="register new user"><br />
                <span class="imgNote">[Image 2]. A new user registers on the system.</span>
              </div>
            </section>
            <!-- login design -->
            <section class="small-12 large-12 columns">
              <div class="small-12 large-3 panel columns">
                <p>The diagram from the right shows the interaction among the components when a user log into the system (<a id="login_design_show">show</a> | <a id="login_design_hide">hide</a>).</p>
              </div>
              <div id="login_design" class="small-12 large-9 panel columns">
                <p><span class="important">Login. </span></p>
                <img src="images/register_design.png" alt="register new user"><br />
                <span class="imgNote">[Image 3]. A new user registers on the system.</span>
              </div>
            </section>
            <!-- registration call design -->
            <section class="small-12 large-12 columns">
              <a id="callRegistration"></a>
              <div class="small-12 large-3 panel columns">
                <p>The diagram from the right shows the interaction among the components when a user registers a call on the system (<a id="call_design_show">show</a> | <a id="call_design_hide">hide</a>).It is assumed that the user is already logged into the system.</p>
              </div>
              <div id="call_design" class="small-12 large-9 panel columns">
                <p><span class="important">Call registration. </span></p>
                <img src="images/call_design.png" alt="register call design"><br />
                <span class="imgNote">[Image 4]. A new call registration is stored on the system.</span>
              </div>
            </section>
            <!-- search design -->
            <section class="small-12 large-12 columns">
            <a id="searchPerson"></a>
              <div class="small-12 large-3 panel columns">
                <p>The diagram from the right shows the interaction among the components when a wants to perform a search for a person on the system (<a id="search_design_show">show</a> | <a id="search_design_hide">hide</a>). It is assumed that the user is already logged into the system and it has access to the module.</p>
              </div>
              <div id="search_design" class="small-12 large-9 panel columns">
                <p><span class="important">Search. </span></p>
                <img src="images/search_design.png" alt="search design"><br />
                <span class="imgNote">[Image 5]. Search of a person.</span>
              </div>
            </section>
            <!-- charts design -->
            <section class="small-12 large-12 columns">
            <a id="chartsFlow"></a>
              <div class="small-12 large-3 panel columns">
                <p>The diagram from the right shows the interaction among the components when a wants to generate the charts on the system (<a id="charts_design_show">show</a> | <a id="charts_design_hide">hide</a>). It is assumed that the user is already logged into the system and it has access to the module.</p>
              </div>
              <div id="charts_design" class="small-12 large-9 panel columns">
                <p><span class="important">Charts. </span></p>
                <img src="images/charts_design.png" alt="charts design"><br />
                <span class="imgNote">[Image 6]. Charts components interaction.</span>
              </div>
            </section>
          </div> <!-- high level design -->
          <!-- User interface section -->
          <div id="user_interface" class="small-12 large-12 columns">
            <a id="user_interface"></a>
            <h4 data-magellan-destination="user_interface" class="cheaders">5. User interface design</h4>
            <hr class="chr">
            <p class="panel callout radius">The system is built using the front-end framework called <span class="important">Foundation.</span> The framework is designed by dividing the width of the screen in twelve columns, which can be configured for small, medium or large devices. Besides to provide a responsive design, it also offer many interface elements, some of the important elements used on the system are: </p>
              <!-- Navigation menu -->
              <div class="large-7 small-12 panel columns">
                <ul class="customList">
                  <li><span class="important">Navigation menu.</span> It provides the navigation on the system to access the different modules. Also, the menu respond to the size of the screen.</li>
                </ul>
                <img src="images/nav.png" alt="navigation menu code"><br />
                <span class="imgNote">[Image 7]. Navigation menu, code in "/Views/Shared/_Layout.cshtml".</span>
              </div>
              <div class="large-5 small-12 columns">
                <p>Besides of using the CSS from Foundation, it is required to add the following scripts in order to have a responsive design.</p>
                <code>
                  @Scripts.Render("~/bundles/jquery")
                  @Scripts.Render("~/Scripts/foundation.js")
                  @Scripts.Render("~/Scripts/foundation.topbar.js")
                </code>
                <p>And include the next line of code inside a script, after the call to the javascript files mentioned.</p>
                <code>
                  $(document).foundation();
                </code>
                <p><span class="imgNote">Code in "/Views/Shared/_Layout.cshtml".</span></p>
              </div>
              <!-- end navigation menu-->
            <!-- Responsive tables -->
            <div class="large-7 small-12 panel columns">
              <ul class="customList">
                <li><span class="important">Responsive tables.</span></li>
              </ul>
              <img src="images/responsive_tables.png" alt="responsive tables"><br />
              <span class="imgNote">[Image 8]. Responsive tables, code in "/Views/Shared/_Layout.cshtml".</span>
            </div>
            <div class="large-5 small-12 columns">
              <p>To get the responsive tables work it is required to add the javascript: <code>@Scripts.Render("~/Scripts/responsive-tables.js")</code> and the CSS <code>@Styles.Render("~/Content/responsive-tables.css")</code>.</p>
              <p><span class="imgNote">Code in "/Views/Shared/_Layout.cshtml".</span></p>
            </div>
            <!-- Responsive -->
            <div class="large-12 small-12 columns">
              <p>The next screenshot shows how the system looks in different sizes, depending on the device (<a id="responsive_design_show">show</a> | <a id="responsive_design_hide">hide</a>).</p>
              <div id="responsive_design" class="large-8 small-12 panel columns" style="display:none">
                <img src="images/responsive.png" alt="responsive system"><br />
                <span class="imgNote">[Image 9]. Responsive system. <a href="http://ami.responsivedesign.is/">Am I responsive?</a>.</span>
              </div>
            </div>
            <div class="large-12 small-12 columns">
              <blockquote>References: 
                <ul>
                  <li>ZURB, i. (2014). Getting Started | Foundation Docs. [online] Foundation.zurb.com. Available at: http://foundation.zurb.com/docs/ </li>
                  <li>Ami.responsivedesign.is, (2014). Am I Responsive?. [online] Available at: http://ami.responsivedesign.is/ </li>
                </ul>
              </blockquote>
            </div>
            <!-- end Responsive -->
          </div> <!-- end user interface -->
          <!-- validation section -->
          <div id="validation" class="small-12 large-12 columns">
            <a id="validation"></a>
            <h4 data-magellan-destination="validation" class="cheaders">6. Validation</h4>
            <hr class="chr">
            <div class="panel callout radius">
              <p>All the forms used in the system has validation to configure, to prevent the user to submit empty or wrong information. The configuration of the validation is divided in two parts: 
              </p>
              <ol class="customList">
                <li>In the Model for each property that by design it needs to be checked. This way to do it allow us to take advantage of Razor and generate HTML in a clean and faster way.</li>
                <li>In the View using Razor syntax, specifiying which property of the model and indicating that its for validation</li>
              </ol>
            </div>
            <p>For example:</p>
            <p>The Model Registration <span class="imgNote">(code in "/Models/Registration.cs")</span> specifies which data is required and the text for the label.</p>
            <p>
            <pre>
            [Required(ErrorMessage = "A phone number is required")]
            [Display(Name = "Phone number:")]
            public int PhoneNumber { get; set; }
            </pre>
            </p>
            <p>In the View <span class="imgNote">(code in "/Views/Call/Register.cshtml")</span> at the top of the page it specifies which Model is going to be used for the view. To retrieve or assign data from the model is as follows:</p>
            <p>Set validation to true <code>@Html.ValidationSummary(true)</code> and then
            <br/>
            <pre>
            @Html.LabelFor(m => m.PhoneNumber)(gets the display name: "Phone number")
            @Html.TextBoxFor(m => m.PhoneNumber)(assign the value to PhoneNumber)
            @Html.ValidationMessageFor(m => m.PhoneNumber)(gets the ErrorMessage: "A phone number is required")
            </pre>
            </p>
            <p>
            In case the user submits the form with one or more empty fields the error message will be displayed. Same behavior when using Ajax, the system will not communicate with the server until the data is correct.</p>
            <div class="panel">
              <img src="images/validation.png" alt="validation message"><br />
              <span class="imgNote">[Image 10]. Validation message.</span>
            </div>
            <div class="panel">
              <p><span class="important">Note: </span> this only shows an example of how validation is configured in one of the models from the project, the models/views that have validation are:</p>
              <ul>
                <li>Model Registration.cs <span class="imgNote">(code in "/Models/Registration.cs")</span> / View: Call/Register <span class="imgNote">(code in "/Views/Call/Register.cshtml")</span>.</li>
                <li>Model Search.cs <span class="imgNote">(code in "/Models/Search.cs")</span> / View: Person/Search <span class="imgNote">(code in "/Views/Person/Search.cshtml")</span>.</li>
                <li>Model Chart.cs <span class="imgNote">(code in "/Models/Chart.cs")</span> / View: Account/Login, Account/Register <span class="imgNote">(code in "/Views/Account/Login.cshtml", "/Views/Account/Register.cshtml")</span>.</li>
                <li>Model AccountModels.cs <span class="imgNote">(code in "/Models/AccountModels.cs")</span> / View: Chart/Index <span class="imgNote">(code in "/Views/Chart/Index.cshtml")</span>.</li>
              </ul>
            </div>
          </div><!-- End validation -->
          <!--Authentication -->
          <div id="authentication" class="small-12 large-12 columns">
            <a id="authentication"></a>
            <h4 data-magellan-destination="authentication" class="cheaders">7. Authorization</h4>
            <hr class="chr">
            <div class="panel callout radius">
              <p>The user must have authorization to access the modules, by defaut it can only access to registration call. <span class="important">AuthorizeCore: </span> it is an ovverriden method in order to check wheter the user is being authorized. Has two parameters:</p>
              <ul>
                <li>HtttpContext: It is for collecting an information about each single request. It returns false if the user is not authorized.</li>
                <li>OnAuthorization: It is an overriden method in order to redirect the user to Unauthorized page. According to (MSDN), this method is called "when a process requests authorization"</li>
              </ul>
            </div>
            <div class="small-12 large-6 panel columns">
              <img src="images/Authorize.jpg" alt="authorize"><br />
              <span class="imgNote">[Image 11]. Validation message.</span>
              <br />
              <p><span class="important">Note: </span> the code can be found in the controller "AuthorizeAttribute" can be found at: /controllers/AuthorizeAttribute.cs.</p>
            </div>
            <div class="small-12 large-12 columns">
              <a id="references"></a>
              <hr class="chr">
              <blockquote>References: 
                <ul>
                  <li>Msdn.microsoft.com. AuthorizeAttribute Class. [online] Available at: http://msdn.microsoft.com/en-us/library/system.web.mvc.authorizeattribute.onauthorization(v=vs.118).aspx </li>
                  <li>stackoverflow.com. ASP.NET MVC - How to show unauthorized error on login page?. [online] Available at: http://stackoverflow.com/questions/1498727/asp-net-mvc-how-to-show-unauthorized-error-on-login-page
                </ul>
            </div>
          </div>
          <!-- end authentication -->
          <!-- implementation section -->
          <div id="implementation" class="small-12 large-12 columns">
            <a id="implementation"></a>
            <h4 data-magellan-destination="implementation" class="cheaders">8. Implementation</h4>
            <hr class="chr">
            <div class="panel callout radius">
              <p>An explanation and features of each module from the system are going to be presented in this section.</p>
            </div>
            <div class="small-12 large-12 columns"> <!-- register -->
              <h5 class="cheaders">8.1 Register</h5>
              <hr class="chr">
              <div class="panel callout radius">
                <p>In case that the information has been entered correctly, the data will be stored in database by a WebSecurity.CreateUserAndAccount(model.UserName, model.Password) method and direct the user to Registration Page for call. Another important elements are:</p>
                <ul>
                  <li>[AllowAnnonymous]: It is an attribute determinig the controllers and actions "are skipped by AuthorizeAttribute during authorization" (Microsofr MSDN 1).</li>
                  <li>[ValidateAntiForgeryToken]: It is an attribute used to "prevent forgery of a request" (Microsofr MSDN 2)</li>
                  <li>ModelState.IsValid: ModelSate "represents the state of an attempt to bind a poster form to an action method, which includes validation information. Where isValid gets a value determining if instance of this model-stat dictiornary is valid" (Microsofr MSDN 3). For example, passing a string for a parameter which should be an integer.
                </ul>
              </div>
              <div class="small-12 large-6 panel columns">
                <img src="images/RegistrationCode.jpg" alt="authorize"><br />
                <span class="imgNote">[Image 12]. Registration Code.</span>
              </div>
              <div class="small-12 large-12 columns">
               <p><span class="important">Note: </span> the code can be found in the controller "AccountController" can be found at: /controllers/AccountController.cs, the model "AccountModels.cs" found at /Models/AccountModels and the view "register.cshtml" found at: /Views/Account/register.cshtml.</p>
              </div>
              <div class="small-12 large-12 columns">
              <a id="references"></a>
              <hr class="chr">
              <blockquote>References: 
                <ul>
                  <li>Microsoft MSDN 1. System.Web.Http [online] Available at: http://msdn.microsoft.com/en-us/library/system.web.http.allowanonymousattribute%28v=vs.118%29.aspx </li>
                  <li>Microsoft MSDN 2. System.Web.MVC [online] Available at: http://msdn.microsoft.com/en-us/library/system.web.mvc.validateantiforgerytokenattribute%28v=vs.118%29.aspx </li>
                  <li>Microsoft MSDN 3. Model State Class [online] Available at: http://msdn.microsoft.com/en-us/library/system.web.mvc.modelstate%28v=vs.118%29.aspx </li>
                </ul>
            </div>
            <div class="small-12 large-12 columns"> <!-- login -->
              <h5 class="cheaders">8.2 Login</h5>
              <hr class="chr">
              <div class="panel callout radius">
                <p>In case username and password have been entered, the data will be matched with database records by a WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe) method and redirect a user to Registration Page for call. Another important elements are:</p>
              </div>
              <div class="small-12 large-6 panel columns">
                <img src="images/LoginCode.png" alt="authorize"><br />
                <span class="imgNote">[Image 13]. Login Code.</span>
              </div>
              <div class="small-12 large-12 columns"
                <p><span class="important">Note: </span> the code can be found in the controller "AccountController" can be found at: /controllers/AccountController.cs, the model "AccountModels.cs" found at /Models/AccountModels and the view "login.cshtml" found at: /Views/Account/login.cshtml.</p>
              </div>
            </div>
            <div class="small-12 large-12 columns"> <!-- register a call -->
              <h5 class="cheaders">8.3 Register a call</h5>
              <hr class="chr">
              <p class="panel callout radius">The main flow of actions for this module can be found in the diagram <a href="#callRegistration">Call Registration</a>. The main features of this component are: Validation (see section <a href="#validation">Validation</a> for more information); Ajax communication to retrieve information given a phone number, in order to fill fields automatically and create historic table; create a new entry in the database.</p>
              <p>Besides ASP.NET MVC the technologies used are: Jquery, Ajax, JSON.</p>
              <div class="small-12 large-12 columns"> <!-- Register a call ajax/json -->
                <h6 class="cheaders">7.3.1 Register a call - submit - Ajax/Json</h6>
                <hr class="chr">
                <p class="panel callout radius">The component was designed to communicate with the database via AJAX with the objective to provide fast and dynamic information to the employee, without the need to refresh the web page or go to another component.</p>
                <p>After the user submits the form the first action from the system is to validate the fields, if all the fields are correct the data is going to be serialize in JSON format and send to the controller, the class that executes this action is Registration.js <span class="imgNote">(code in "/Scripts/Custom/registration.js")</span>, as shown below:</p>
                <div class="small-12 large-6 columns">
                  <div class="panel">
                  <span class="important">Registration.js</span>
<pre>
if ($("form").valid()) {   
  // Disable the button
  $('input[type="submit"]').prop('disabled', true);
  $.ajax({
     type: "POST",
     url: form.attr('action'),
     dataType: 'json',
     ContentType: 'application/json',
     data: $("form").serialize()
}) 
...
</pre>      
                <br />
                <span class="imgNote">1. First step, data serialize and send to controller.</span>
              </div>
                </div> <!-- registration .js -->
                <div class="small-12 large-6 columns">
                  <div class="panel">
                  <span class="important">Registration.js</span>. After the response from the controller:
<pre>
 if (data === true) {
    $('input[type="submit"]').prop('disabled', false);
    $('div#messages').attr('class', 'alert-box success radius');
    $('div#messages').show();
    $('div#messages').text("The information of the call has been successfully saved").fadeOut(4000);
    // Clean the fields of the form to leave them ready the form for the next call.
    $('input#PhoneNumber').val('');
...
}
...
</pre>          <br />
                <span class="imgNote">3. Third step, the javascript receives the data from the controller and displays the message.</span>
              </div>
                </div> <!-- registration .js -->

                <div class="small-12 large-12 columns">
                  <div class="panel">
                  <span class="important">CallController.cs</span>
                  The action in the controller will return JSON. If model is valid and the person who called is already registered on the database, his address is going to be update it. Otherwise, register a new person and a new call.
<pre>
[HttpPost]
public JsonResult Register(Models.Registration registration)
...
if (ModelState.IsValid)
{
...
  var aux = (from ca in db.Categories
             where ca.CategoryName.Equals(registration.Categories)
             select ca).Single();
  Person person = new Person(registration.PhoneNumber, registration.Name, registration.LastName, registration.Address1, registration.Address2, registration.PostCode);
  // Check if a person already exists on the table with that phone number.
  var checkPerson = db.Persons.Any(p => p.PhoneNumber == person.PhoneNumber);
  var userName = WebSecurity.CurrentUserName;
  var checkEmployee = db.Employees.Any(e => e.Name == userName);
  Employee tmpEmployee = null;

  if(checkEmployee)
      tmpEmployee = db.Employees.Single(e => e.Name == userName);

  if (checkPerson && checkEmployee)
  {
      Person tmpPerson = db.Persons.Single(p => p.PhoneNumber == person.PhoneNumber)
      if (TryUpdateModel(tmpPerson, new string[] { "Name", "LastName", "Address1", "Address2", "PostCode" }))
      {
        ...
        db.Entry(tmpPerson).State = EntityState.Modified;
        db.SaveChanges();
        Call call = new Call(aux.CategoryId, tmpEmployee.EmployeeId, registration.Program, registration.Comments, registration.Positive, tmpPerson);
        db.Calls.Add(call);
        db.SaveChanges();
        ...
      }
  }
  else
  {
      Call call = new Call(aux.CategoryId, tmpEmployee.EmployeeId, registration.Program, registration.Comments, registration.Positive, person);
      db.Calls.Add(call);
      db.SaveChanges();
  }
  return Json(true);
  ...
}
return Json(false);
</pre>
                <br />
                <span class="imgNote">2. Second step, response in JSON format from the controller.</span>
              </div>
                </div> <!-- controller -->
              </div> <!-- register a call submit -->
              <div class="small-12 large-12 columns"> <!-- Register a call - phone number - ajax/json -->
                <h6 class="cheaders">7.3.2 Register a call - phone number typed - Ajax/Json</h6>
                <hr class="chr">
                <p class="panel callout radius">After a user type the phone number, the .js file will read the value and communicate with the controller to retrieve information about the person.</p>
                <div class="small-12 large-6 columns">
                  <div class="panel">
                  <span class="important">Registration.js</span>. User focus out from the phone number field, an ajax call will be created:
<pre>
...
$.ajax({
    type: 'POST',
    url: '/Call/Complete',
    data: { phoneNumber: phoneNumber },
    dataType: "json",
    ContentType: 'application/json'
})
...
</pre>        
                  <br />
                  <span class="imgNote">1. First step, get phone number value and communicate with the controller.</span>
                </div>
              </div> <!-- registration .js -->
              <div class="small-12 large-6 columns">
                  <div class="panel">
                  <span class="important">Registration.js</span>. After the response from the controller, fill the fields with the data:
<pre>
...
.success(function (data) {
if (data !== false) {
    // Clean error messages from the screen and append the span back to be able to show future error messages.
    $('span[data-valmsg-for="PhoneNumber"]').remove();
    $('#errorPhoneNumber').append("<span class='field-validation-valid' data-valmsg-for='PhoneNumber' data-valmsg-replace='true'></span>");
    $('input#Name').val(data.Name);
    $('span[data-valmsg-for="Name"]').remove();
    $('#errorName').append("<span class='field-validation-valid' data-valmsg-for='Name' data-valmsg-replace='true'></span>");
    $('input#LastName').val(data.LastName);
...
</pre>      
                  <br />
                  <span class="imgNote">3. Third step, fill in the fields.</span>
                </div>
              </div> <!-- registration .js -->
              <div class="small-12 large-12 columns">
                <div class="panel">
                  <span class="important">CallController.cs, Complete action</span>
                  The action in the controller will return the model modified in JSON format.
<pre>
[HttpPost]
public JsonResult Complete(Models.Registration registration)
{
    var aux = db.Persons.Any(p => p.PhoneNumber == registration.PhoneNumber);
    if (aux)
    {
        Person tmpPerson = db.Persons.Single(p => p.PhoneNumber == registration.PhoneNumber);

        registration.Name = tmpPerson.Name;
        registration.LastName = tmpPerson.LastName;
        registration.Address1 = tmpPerson.Address1;
        registration.Address2 = tmpPerson.Address2;
        registration.PostCode = tmpPerson.PostCode;
        return Json(registration);
    }
    return Json(false);
}
</pre>
                <br />
                <span class="imgNote">2. Second step, the controller modifies the received model.</span>
              </div>
            </div>
              </div> <!-- phone number typed -->
              <div class="small-12 large-12 columns"> <!-- Register a call phone typed - ajax/json -->
                <h6 class="cheaders">7.3.3 Register a call - historical data - Ajax/Json</h6>
                <hr class="chr">
                <p class="panel callout radius">After a user type the phone number, the .js file will read the value and communicate with the controller to retrieve information about the historical data of the person.</p>
                <div class="small-12 large-12 columns">
                  <div class="panel">
                  <span class="important">Registration.js</span>. User focus out from the phone number field, an ajax call will be created:
<pre>
...
 $.ajax({
    type: 'POST',
    url: '/Call/Historical',
    data: { phoneNumber: phoneNumber },
    dataType: "json",
    ContentType: 'application/json'
})
...
</pre>      
                  <br />
                  <span class="imgNote">1. First step, get phone number value and communicate with the controller.</span>
                </div>
              </div> <!-- registration .js -->
              <div class="small-12 large-12 columns">
                <div class="panel">
                  <span class="important">CallController.cs, Complete action</span>
                  The action in the controller will return the model modified in JSON format.
<pre>
...
var aux = db.Persons.Any(p => p.PhoneNumber == registration.PhoneNumber);
if (aux)
{
    Person tmpPerson = db.Persons.Single(p => p.PhoneNumber == registration.PhoneNumber);
    var bCalls = db.Calls.Any(c => c.Person.PersonId == tmpPerson.PersonId);
    if (bCalls)
    {
        var calls = (from ca in db.Calls
                     join a in db.Categories on ca.CategoryId equals a.CategoryId
                     where ca.Person.PersonId == tmpPerson.PersonId
                     orderby ca.TimeCall descending
                     select new {ca.Program, a.CategoryName, ca.Comments, ca.Positive, ca.TimeCall});

        List<Historic> lCall = new List<Historic>();
        int cPositive = 0;
        int cNegative = 0;
        foreach (var c in calls)
        {
            Historic call = new Historic(c.Program, c.CategoryName, c.Comments, c.Positive, c.TimeCall.ToString());
            if (c.Positive)
                cPositive++;
            else
                cNegative++;
            lCall.Add(call);
        }
        return Json(new { Name = tmpPerson.Name, LastName = tmpPerson.LastName, Address1 = tmpPerson.Address1, Address2 = tmpPerson.Address2, PostCode = tmpPerson.PostCode, nPositive = cPositive, nNegative = cNegative, Calls = lCall });
    }
    else
        return Json(false);
...
</pre>  
                <br />
                <span class="imgNote">2. Second step, the controller modifies the received model.</span>
              </div>
            </div>
            <div class="small-12 large-6 columns">
                  <div class="panel">
                  <span class="important">Registration.js</span>. After the response from the controller, send message about reputation from the person:
<pre>
...
// Check if the number of positive comments are equal to the number of negative comments
if (data.nPositive === data.nNegative) {
    $('div#messages').attr('class', 'alert-box info round');
    $('div#messages').show();
    $('div#messages').text("The user has the same number of positive and negative comments").fadeOut(3000);
}
else if (data.nPositive > data.nNegative) {
    // Notify if the user has a good reputation (more positive comments than negative)
    $('div#messages').attr('class', 'alert-box info round');
    $('div#messages').show();
    $('div#messages').text("The user has a reputation of positive comments").fadeOut(3000);
}
else {
    // Notify if the user has a bad reputation when calling (more negative comments than positive)
    $('div#messages').attr('class', 'alert-box warning round');
    $('div#messages').show();
    $('div#messages').text("The user has a reputation of negative comments").fadeOut(3000);
...
</pre>      
                  <br />
                  <span class="imgNote">3. Third step part 1, show message regard the reputation.</span>
                </div>
              </div> <!-- registration .js -->
              <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">Registration.js</span>. Part 2, create table with historical data.
                    <img src="images/phone_historical.png" alt="code"><br />    
                    <span class="imgNote">4. Third step part 2, historical data.</span>
                  </div>
                  
              </div> <!-- registration .js -->
              </div> <!-- phone number historical typed -->
              <div class="small-12 large-12 columns">
                <hr class="chr">
                <p><span class="important">Note: </span> the javascript file "Registration.js" can be found at /Scripts/Custom/registration.js, the controller "CallController" can be found at: /controllers/CallController.cs, model used "Registration" found at: /Models/Registration.cs, View used "Register.cshtml" found at: /Views/Call/Register.cshtml</p>
              </div>
            </div> <!-- register a call -->
            <!-- search -->
            <div class="small-12 large-12 columns"> 
              <h5 class="cheaders">8.4 Search a person</h5>
              <hr class="chr">
              <p class="panel callout radius">The main flow of actions for this module can be found in the diagram <a href="#searchPerson">Search person</a>. The main features of this component are: Validation (see section <a href="#validation">Validation</a> for more information); Ajax communication to retrieve information given a a name or phone number, in order to create a table with the results.</p>
              <div class="small-12 large-6 columns">
                <div class="panel">
                  <span class="important">search.js</span>. User select a search criteria, typed a value and clicked on the button:
<pre>
...
$.ajax({
    type: "POST",
    url: form.attr('action'),
    dataType: 'json',
    ContentType: 'application/json',
    data: $("form").serialize()
    //data: stringfied
})
...
</pre>      
                  <br />
                  <span class="imgNote">Use ajax to communicate with the controller.</span>
                </div>
              </div> <!-- search .js -->
              <div class="small-12 large-6 columns">
                <div class="panel">
                  <span class="important">PersonController, search action</span>. The controller receives the data and looks in the database to retrieve the information.
<pre>
[HttpPost]
public JsonResult Search(Models.Search search)
{
    if (search.Criteria.ToLower().Equals("phone number"))
    {
        int n;
        bool isNumeric = int.TryParse(search.Value, out n);
        if (isNumeric)
        {
            var checkPerson = db.Persons.Any(p => p.PhoneNumber == n);
            if (checkPerson)
            {
                var people = (from p in db.Persons
                              where p.PhoneNumber == n
                              orderby p.PhoneNumber descending
                              select p);

                List<Person> lPerson = new List<Person>();
                foreach (var p in people)
                {
                    Person person = new Person(p.PersonId, p.PhoneNumber, p.Name, p.LastName, p.Address1, p.Address2, p.PostCode);
                    lPerson.Add(person);
                }
                return Json(new { success = true, people = lPerson });
            }
            else
                return Json(new { success = false, errorMessage = "No results found" });

        }
        else
            return Json(new { success = false, errorMessage = "The phone number must be only digits" });
    }
    else if (search.Criteria.ToLower().Equals("name"))
    {
        var checkPerson = db.Persons.Any(p => p.Name.Contains(search.Value) || p.LastName.Contains(search.Value));
        if (checkPerson)
        {
            var people = (from p in db.Persons
                          where p.Name.Contains(search.Value) || p.LastName.Contains(search.Value)
                          orderby p.LastName descending
                          select p);

            List<Person> lPerson = new List<Person>();
            foreach (var p in people)
            {
                Person person = new Person(p.PersonId, p.PhoneNumber, p.Name, p.LastName, p.Address1, p.Address2, p.PostCode);
                lPerson.Add(person);
            }
            return Json(new { success = true, people = lPerson });
        }
        else
            return Json(new { success = false, errorMessage = "No results found" });

    }
    return Json(new { success = false, errorMessage = "Criteria must be name or phone number" });
}
</pre>
                </div>
              </div>
              <div class="small-12 large-6 columns">
                <div class="panel">
                  <span class="important">search.js</span>. The response is received a message is displayed on the screen (success or failure).
<pre>
...
$('input[type="submit"]').prop('disabled', false);
$('div#messages').attr('class', 'alert-box success radius');
$('div#messages').show();
$('div#messages').text("Search successful").fadeOut(4000);
...
$('div#messages').attr('class', 'alert-box alert radius');
$('div#messages').show();
$('div#messages').text(data.errorMessage).fadeOut(4000);
$('input[type="submit"]').prop('disabled', false);
...
</pre>      
                  <br />
                  <span class="imgNote">Code to generate/show the messages.</span>
                </div>
              </div> <!-- search .js -->
              <div class="small-12 large-6 columns">
                <div class="panel">
                  <span class="important">search.js</span>. Besides the message, the table is generated.
                   <img src="images/history_results.png" alt="code"><br />    
                  <span class="imgNote">Code to generate results table.</span>
                </div>
              </div> <!-- search .js -->
              <!-- NOTE -->
              <div class="small-12 large-12 columns">
                <hr class="chr">
                <p><span class="important">Note: </span> the javascript file "search.js" can be found at /Scripts/Custom/search.js, the controller "PersonController" can be found at: /controllers/PersonController.cs, model used "Search" found at: /Models/Search.cs, View used "search.cshtml" found at: /Views/Person/search.cshtml</p>
              </div>
              <!-- 8.4.1 check history -->
               <div class="small-12 large-12 columns"> 
                <h6 class="cheaders">8.4.1 Search a person - check history</h6>
                <hr class="chr">
                <p class="panel callout radius">In the past section a table was generated with the data from the database, in the table a link is created to check the history of one person.</p>
                <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">PersonController - Details action</span>. Receives the ID of a user.
  <pre>
[HttpGet]
public ActionResult Details(long id)
{
    var checkPerson = db.Persons.Any(p => p.PersonId.Equals(id));
    if (checkPerson)
    {
        Person p = db.Persons.Single(per => per.PersonId == id);
        var calls = (from call in db.Calls
                    join categories in db.Categories on call.CategoryId equals categories.CategoryId
                    join person in db.Persons on call.Person.PersonId equals person.PersonId
                    where call.Person.PersonId == id
                    orderby call.TimeCall descending
                    select new { call.Program, categories.CategoryName, call.Comments, call.Positive, call.TimeCall});
        List<Historic> lCall = new List<Historic>();
        foreach (var c in calls)
        {
            Historic call = new Historic(c.Program, c.CategoryName, c.Comments, c.Positive, c.TimeCall.ToString());
            lCall.Add(call);
        }
        Details details = new Details(lCall, p);
        return View(details);
    }
    return View();
}
  </pre>      
                    <br/>
                    <span class="imgNote">Action code in the controller.</span>
                  </div> <!--panel-->
                </div> <!-- controller -->
                <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">View: Details.cshtml</span>. Display general information about the user (personal information) and all the calls registered.
                    ...
                    <img src="images/general_info.png" alt="code"><br />
                    <br />...
                    <img src="images/calls_table.png" alt="code"><br />
                    ...<br />
                    <span class="imgNote">Code in the view display information.</span>     
                  </div> <!--panel-->
                </div> <!-- View -->
              </div> <!-- end 8.4.1 check history -->
               <!-- NOTE -->
              <div class="small-12 large-12 columns">
                <hr class="chr">
                <p><span class="important">Note: </span> the controller "PersonController" (details action) can be found at: /controllers/PersonController.cs, model used "Details" found at: /Models/Details.cs, View used "details.cshtml" found at: /Views/Person/details.cshtml</p>
              </div>
            </div><!-- end search -->
            <!-- Charts -->
            <div class="small-12 large-12 columns"> 
              <h5 class="cheaders">8.5 Charts</h5>
              <hr class="chr">
              <div class="panel callout radius"> 
                <p>The main flow of actions for this module can be found in the diagram <a href="#chartsFlow">charts</a>. The main features of this component are: Validation (see section <a href="#validation">Validation</a> for more information); Ajax communication to retrieve calls information for the specified range of dates, generation of charts. Use of JQuery-UI to use calendar for the dates.</p>
                <p>To generate the Charts the library HighCharts was used, the website has an API documentation and demo about how to use the library. The labels in the charts.js for the charts were set as well as the set of data used to display the chart.</p>
              </div>
              <p><span class="important">Note: </span> it is required to have highcharts.js script in order to generate the charts.</p>
              <div class="small-12 large-12 columns">
                <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">JQuery-UI calendar</span>. JQuery.cs, JQuery-UI.js and JQuery-ui-*.css are required.
  <pre>
$(function () {
  $("#FromDate").datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      onClose: function (selectedDate) {
          $("#ToDate").datepicker("option", "minDate", selectedDate);
      }
  });
  $("#ToDate").datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      onClose: function (selectedDate) {
          $("#FromDate").datepicker("option", "maxDate", selectedDate);
      }
  });
});
  </pre>      
                    <br/>
                    <span class="imgNote">JQuery - UI calendar.</span>
                  </div> <!--panel-->
                </div> <!-- calendar -->
                <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">Charts.js</span>. Communicates with the controller via Ajax.
  <pre>
$.ajax({
    type: "POST",
    url: '/Chart/GetInfo',
    dataType: 'json',
    ContentType: 'application/json',
    data: $("form").serialize()
})
  </pre>      
                    <br/>
                    <span class="imgNote">Charts script - ajax.</span>
                  </div> <!--panel-->
                </div> <!-- charts -->
              </div><!-- row-->
             <div class="small-12 large-12 columns">
              <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">ChartController - Get info action</span>. Retrieves calls information between the range of dates and sends the data in JSON format.
  <pre>
[HttpPost]
public JsonResult GetInfo(Models.Chart charts)
{
    if (ModelState.IsValid)
    {
        DateTime fromDate = Convert.ToDateTime(charts.FromDate);
        DateTime toDate = Convert.ToDateTime(charts.ToDate);

        var checkCall = db.Calls.Any(c => c.TimeCall >= fromDate && c.TimeCall <= toDate);
        if (checkCall)
        {
            var calls = (from call in db.Calls
                         join categories in db.Categories on call.CategoryId equals categories.CategoryId
                         join person in db.Persons on call.Person.PersonId equals person.PersonId
                         where call.TimeCall >= fromDate && call.TimeCall <= toDate
                         orderby call.TimeCall ascending
                         select new { call.Program, categories.CategoryName, call.Comments, call.Positive, call.TimeCall, call.Person.PersonId });
 ...
 return Json(new { success = true, FromDate = charts.FromDate, ToDate = charts.ToDate, CategoryNames = lCategories, CategoryCount = iCategories, Dates = lDates, DatesCount = iDates, People = iPeople, Positive = nPositive, Negative = nNegative, PMorning = pMorning, PAfternoon = pAfternoon, TotalCalls = totalCalls });
}
else
    return Json(new { success = false, errorMessage = "No calls registered between " + charts.FromDate + " to " + charts.ToDate});
...
  </pre>      
                    <br/>
                    <span class="imgNote">Get info from the controller/action.</span>
                  </div> <!--panel-->
                </div> <!-- controller -->
                <div class="small-12 large-6 columns">
                  <div class="panel">
                    <span class="important">charts.js</span>. Show message, create section of general information and manipulate data to create charts.
  <pre class="sPerson2">
$('div#messages').attr('class', 'alert-box success radius');
$('div#messages').show();
$('div#messages').text("Calls found between " + data.FromDate + " to " + data.ToDate).fadeOut(4000);
...
</pre>
                        <img src="images/charts_code.png" alt="code"><br />
<pre>
series: [{
    name: 'Calls on the day',
    data: nCalls
}]
...
  </pre>      
                    <br/>
                    <span class="imgNote">Display message, general information and generate charts.</span>
                  </div> <!--panel-->
                </div> <!-- charts -->
             </div><!-- row-->
            </div> <!-- 8.5 -->
            <div class="small-12 large-12 columns">
              <hr class="chr">
              <p><span class="important">Note: </span> the controller "ChartsController" (action: getInfo) can be found at: /controllers/ChartController.cs, model used "Chart" found at: /Models/Chart.cs, View used "index.cshtml" found at: /Views/Chart/index.cshtml</p>
            </div>
            <div class="small-12 large-12 columns"> <!-- control panel -->
              <h5 class="cheaders">8.6 Control Panel</h5>
              <hr class="chr">
              <p class="panel callout radius">The main features of this component are: Autherization (see section <a href="#authentication">Autherization</a> for more information); Dealing with roles. (see section <a href="#database">Database</a> for more information).</p>
              <!-- 8.4.1 check history -->
               <div class="small-12 large-12 columns"> 
                <h6 class="cheaders">8.6.1 Control Panel - List of Roles</h6>
                <hr class="chr">
                <p class="panel callout radius">

                  The first paremeter is a name of the link <br />
                  The second parameter is a controller will be called <br />
                  The  parameter is new AjaxOptin containing the following <br />
                  <a class="command">HttpMethod: </a> It is set to Get because in this case the situation is response. <br />
                  <a class="command">UpdateTargetId: </a> It refers to div tag, that is available at the end of Board View Page, which data will be displyed inside it<br />
                  <a class="command">InsertionMode: </a> Its task is to determine the way, which are replace, insertAfter or insertBefore,  of insert response into the target element. For example, in this code, the option is replace.<br />
                </p>
                  <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">View Board.cshtml</span>. To obtain the roles Ajax is used.
      <pre>
    @Ajax.ActionLink("List of Roles", "UserRole", new AjaxOptions()
    {
        HttpMethod = "GET",
        UpdateTargetId = "divHi",
        InsertionMode = InsertionMode.Replace
    })
      </pre>      
                        <br/>
                        <span class="imgNote">Ajax call.</span>
                      </div> <!--panel-->
                    </div> <!-- calendar -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Account Controller</span>. Obtain roles and display.
      <pre>
    [AuthorizeRedirect(Roles = "Admin")]
    public PartialViewResult UserRole()
    {
        var roles = Roles.GetAllRoles();
        return PartialView("_IndexOfRoles", roles);
    }
      </pre>      
                        <br/>
                        <span class="imgNote">Roles from the controller.</span>
                      </div> <!--panel-->
                    </div> <!-- charts -->
                  </div><!-- row-->
                </div>
                <div class="small-12 large-12 columns"> 
                  <h6 class="cheaders">8.6.2 Control Panel - Add roles</h6>
                  <hr class="chr">
                  <p class="panel callout radius">The admin types a username in the TextBox and choose the right permission for this user from dropDownBox. After the Save is hitted, the code verifies if the user has been assigned this role beforhand by "IsUserInRole", if not an error message will be displayed as shown underneath.</p>
                  <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">AccountController (action: RoleAddToUser)</span>. Link a user to a role.
<pre>
[AuthorizeRedirect(Roles = "Admin")]
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult RoleAddToUser(string RoleName, string UserName)
{
    if (Roles.IsUserInRole(UserName, RoleName))
    {
        ViewBag.ResultMessage = "This user already has the role specified !";
    }
    else
    {
        Roles.AddUserToRole(UserName, RoleName);
        ViewBag.ResultMessage = "Username added to the role succesfully !";
    }

    SelectList list = new SelectList(Roles.GetAllRoles());
    ViewBag.Roles = list;
    return View();
}
</pre>      
                        <br/>
                        <span class="imgNote">Add role to a user.</span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Add role to user</span>.
                         <img src="images/hasArole.jpg" alt="code"><br /> 
                        <span class="imgNote">Add role.</span>
                      </div> <!--panel-->
                    </div> <!-- charts -->
                  </div><!-- row-->
                </div><!--8.6.2 -->
                <div class="small-12 large-12 columns"> 
                  <h6 class="cheaders">8.6.3 Control Panel - Get roles</h6>
                  <hr class="chr">
                  <p class="panel callout radius">As it can be seen from the code, first of all, a none white space should be tested by IsNullOrWhiteSpace inside GetRoles. If it returns false the data will be displayed.  </p> 
                  <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">AccountController (action: GetRoles)</span>. Get roles of a user.
<pre>
[AuthorizeRedirect(Roles = "Admin")]
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult GetRoles(string UserName)
{
    if (!string.IsNullOrWhiteSpace(UserName))
    {
        ViewBag.RolesForThisUser = Roles.GetRolesForUser(UserName);
        SelectList list = new SelectList(Roles.GetAllRoles());
        ViewBag.Roles = list;
    }
    return View("RoleAddToUser");
}
</pre>      
                        <br/>
                        <span class="imgNote">Get roles.</span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Get roles</span>.<br />
                         <img src="images/getRoles.jpg" alt="code"><br /> 
                        <span class="imgNote">Get roles.</span>
                      </div> <!--panel-->
                    </div> <!-- charts -->
                  </div><!-- row-->
                </div><!--8.6.3-->
                <div class="small-12 large-12 columns"> 
                  <h6 class="cheaders">8.6.4 Control Panel - Delete roles</h6>
                  <hr class="chr">
                  <p class="panel callout radius">In this section, the function verfies whether the user has a certain role which is choosen from dropDownBox. If the use has this role a confirmation message will be displayed, otherwise, an error message will be displayed </p> 
                  <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">AccountController (action: DeleteRoleForUser)</span>. Delete roles for a user.
<pre>
[HttpPost]
[AuthorizeRedirect(Roles = "Admin")]
[ValidateAntiForgeryToken]
public ActionResult DeleteRoleForUser(string UserName, string RoleName)
{
    if (Roles.IsUserInRole(UserName, RoleName))
    {
        Roles.RemoveUserFromRole(UserName, RoleName);
        ViewBag.ResultMessage = "Role has been removed from the user successfully !";
    }
    else
    {
        ViewBag.ResultMessage = "This user doesn't have a selected role.";
    }
    ViewBag.RolesForThisUser = Roles.GetRolesForUser(UserName);
    SelectList list = new SelectList(Roles.GetAllRoles());
    ViewBag.Roles = list;

    return View("RoleAddToUser");
}
</pre>      
                        <br/>
                        <span class="imgNote">Delete role to a user.</span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Delete role to user</span>.<br />
                         <img src="images/DeleteRole1.jpg" alt="code"><br /> 
                        <span class="imgNote">Delete role.</span>
                      </div> <!--panel-->
                    </div> <!-- charts -->
                  </div><!-- row-->
                  <span class="important">Note:</span> the code can be found in the controller "AccountController" can be found at: /controllers/AccountController.cs, and the view "create.cshtml" found at: /Views/Account/RoleAddToUser.cshtml.
                </div><!--8.6.4-->
                <div class="small-12 large-12 columns">
                  <a id="references"></a>
                    <hr class="chr">
                    <blockquote>References: 
                      <ul>
                        <li>dotnetfunda.com, (2014). Working with Roles in ASP.NET MVC 4+. [online] Available at: http://www.dotnetfunda.com/articles/show/2648/working-with-roles-in-aspnet-mvc-4 </li>
                        <li>youtube.com, (2014). ASP.NET, ASP.NET MVC, RoleManagement, Membership Beginner. [online] Available at: https://www.youtube.com/watch?v=4TsRsgiU5tA </li>   
                      </ul>
                    </blockquote>
                </div>
            </div>
            <div class="small-12 large-12 columns"> <!-- control panel -->
              <h5 class="cheaders">8.7 Category</h5>
              <hr class="chr">
              <!-- 8.7.1 check history -->
               <div class="small-12 large-12 columns"> 
                <h6 class="cheaders">8.7.1 Category - Add a new category</h6>
                <hr class="chr">
                <p class="panel callout radius">Add a new category, which is located on Board page, must be created by the Admin. After the category has been created, it will be redirected to Index of the categories</p>.
                  <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">CategoryController (action: Create)</span>. 
      <pre>
        public ActionResult Create(Category category)
        {
            if (ModelState.IsValid)
            {
                db.Categories.Add(category);
                db.SaveChanges();
                return RedirectToAction("Index");
            }

            return View(category);
        }
      </pre>
      <br/>
                        <span class="imgNote"></span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Create a new category</span>.<br />
                         <img src="images/createCategory.jpg" alt="code"><br /> 
                        <span class="imgNote">Create Category.</span>

                      </div> <!--panel-->

                    </div> <!-- charts --> 

                  </div><!-- row-->
                  </div>
                  <span class="important">Note:</span> the code can be found in the controller "CategoryController" can be found at: /controllers/CategoryController.cs, the model "CategoryModel.cs" found at />Models/CategoryModel and the view "create.cshtml" found at: /Views/Category/create.cshtml.
                
                  <div class="small-12 large-12 columns"> 
                <h6 class="cheaders">8.7.2 Category - Delete a category</h6>
                <hr class="chr">
                <p class="panel callout radius">Delete a category, which is located on index of categories, must be deleted by the Admin. As it can be seen from the code, the function searches on the specfic category that will be deleted. Afterwards, the latest change is saved on the database </p>                  
                <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">CategoryController (action: Delete)</span>.
      <pre>
        [HttpPost, ActionName("Delete")]
        [ValidateAntiForgeryToken]
        [AuthorizeRedirect(Roles = "Admin")]
        public ActionResult DeleteConfirmed(long id)
        {
            Category category = db.Categories.Find(id);
            db.Categories.Remove(category);
            db.SaveChanges();
            return RedirectToAction("Index");
        }

        protected override void Dispose(bool disposing)
        {
            db.Dispose();
            base.Dispose(disposing);
        }
    </pre>
    <br/>
                        <span class="imgNote"></span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Delete a category</span>.<br />
                         <img src="images/deleteCategory.jpg" alt="code"><br /> 
                        <span class="imgNote">Delete Category.</span>
                      </div> <!--panel-->
                    </div> <!-- charts --> 
                  </div><!-- row-->
                <br />
                      <span class="important">Note:</span> the code can be found in the controller "CategoryController" can be found at: /controllers/CategoryController.cs, the model "CategoryModel.cs" found at />Models/CategoryModel and the view "delete.cshtml" found at: /Views/Category/delete.cshtml.


          <h6 class="cheaders">8.7.3 Category - Update a category</h6>
                <hr class="chr">
                <p class="panel callout radius">Update a category, which is located on index of categories, must be updated by the Admin. As it can be seen from the code, the category name record in database is updated by this "db.Entry(category).State = EntityState.Modified;", which is replaced a new name to the record instead of the old name </p>                  
                <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">CategoryController (action: Edit)</span>.
      <pre>
        [HttpPost]
        [ValidateAntiForgeryToken]
        [AuthorizeRedirect(Roles = "Admin")]
        public ActionResult Edit(Category category)
        {
            if (ModelState.IsValid)
            {
                db.Entry(category).State = EntityState.Modified;
                db.SaveChanges();
                return RedirectToAction("Index");
            }
            return View(category);
        }
    </pre>
    <br/>
                        <span class="imgNote"></span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Update a category</span>.<br />
                         <img src="images/EditCategory.jpg" alt="code"><br /> 
                        <span class="imgNote">Update Category.</span>
                      </div> <!--panel-->
                    </div> <!-- charts --> 
                  </div><!-- row-->
                <br />
                      <span class="important">Note:</span> the code can be found in the controller "CategoryController" can be found at: /controllers/CategoryController.cs, the model "CategoryModel.cs" found at />Models/CategoryModel and the view "Edit.cshtml" found at: /Views/Category/Edit.cshtml.
                <br />
          <h6 class="cheaders">8.7.4 Category - Details of a category</h6>
                <hr class="chr">
                <p class="panel callout radius">Obtaining an information of a certain category must be done by the Admin. As it can be seen from the code, a category name will be found by Id. </p>                  
                <div class="small-12 large-12 columns">
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">CategoryController (action: Details)</span>.
      <pre>
        [AuthorizeRedirect(Roles = "Admin")]
        public ActionResult Details(long id = 0)
        {
            Category category = db.Categories.Find(id);
            if (category == null)
            {
                return HttpNotFound();
            }
            return View(category);
        }
    </pre>
    <br/>
                        <span class="imgNote"></span>
                      </div> <!--panel-->
                    </div> <!-- item -->
                    <div class="small-12 large-6 columns">
                      <div class="panel">
                        <span class="important">Category Details</span>.<br />
                         <img src="images/categoryDetails.jpg" alt="code"><br /> 
                        <span class="imgNote">Category Details.</span>
                      </div> <!--panel-->
                    </div> <!-- charts --> 
                  </div><!-- row-->
                </div>
                <br />
                      <span class="important">Note:</span> the code can be found in the controller "CategoryController" can be found at: /controllers/CategoryController.cs, the model "CategoryModel.cs" found at />Models/CategoryModel and the view "Edit.cshtml" found at: /Views/Category/Details.cshtml.
          </div><!-- end implementation -->
          <!-- Discussion -->
          <div class="small-12 large-12 columns"> 
            <a id="discussion"></a>
            <h4 data-magellan-destination="discussion" class="cheaders">9. Discussion</h4>
            <hr class="chr">
            <p>Before defining the scope and the objective of the project we defined that we were going to use ASP.NET MVC because its a technology that is very used in the work-market and it was something new for both of us. It was not only important to learn a new language, but also a new design pattern like MVC. One of the advantages of MVC is that a system can be divided in different layers. For example, the model define the business logic of an application, while the responsability of the View is to render anything that the application needs to create a great experience to the user. Finally, the controller "asks the model which data to be shown, then it passes the data to the view"; MVC facilitates to have a more organized and clean project.</p>
            <p>However, if there is a comparision between ASP.NET Web forms against ASP.NET MVC, ASP.NET MVC its a technology that requires a lot of time to understand and to learn, while WebForms are easier to learn and allow a quick development of an application. Nevertheless, the intention we had as a team was to learn a little bit about a new technology that is widely used and it would help us to have an overview about the things we can achieve.</p>
            <p>After defining that the best option was ASP.NET MVC (also because was going to be technology to learn in the lectures) we defined which technologies could help us to create a rich user experience to help him to complete his task. </p>
            <p>With this in mind and imagining our system in a real work environment we decided that there must some kind of authentication which "is a process, providing a user ability to access a certain service, based on user's username and password) and authorization which is (a process to specify whether the user has a permission (granting or deny) to access a certain resource. For example, Admin of this project has some roles are completely different from other users, such as, the Admin is able to assign roles to others otherwise users do not have this role), even that the system can be on an intranet, not all the employees should have access, so we decided to implement an this feature using as base what ASP.NET MVC offers out of the box, having an admin role which is the responsible to grant access, create, update or delete users, among other functions.</p>
            <p>Simple membership features have been used in the application. The reason behaind this use is ASP.NET MVC provides a complete database for user accounts and roles which is created by default at the first running of the application. By the latter feature makes manage for users much easier. What is more, ASP.NET MVC allows Admins to deal with tables and you can add fields on database. Additionally, it provides a filter, such as [InitializeSimpleMembership] which has been added to control account to verify the Simple membership has been initialized and create the database if it is not exist (Ciliberti, 273 - 274). (see section <a href="#database">Database</a> for more information)</p>
            <p>Also, it was important to create a system where the user could access as much information as possible on the same, with the idea to avoid the waste of time in navigation among the system. For that reason, during the registration of the call many information is showed to the user, using different technologies as: JQuery, Ajax, Json</p>
            <p>Same technologies were used to implement the search and charts module. However, when designing the charts module we thought in the idea to provide a system that allow a company to review, analyze the information stored in the database, for that reason we decided to create some charts that demostrated the data in a more visual way.</p>
            <p>The use of libraries was easy to set up and use for ASP.NET MVC, in fact, at some point we found that the Foundation Framework also provides a port of foundation for ASP.NET MVC (3-5) <span class="imgNote">(http://responsivemvc.azurewebsites.net//Foundation)</span>. Another important feature provided by ASP.NET MVC was the Entity Framework which helps you to set up a database in a quick and smooth way. </p>
            <p>As conclusion, </p>
          </div>
          <!-- References -->
          <div class="small-12 large-12 columns">
          <a id="references"></a>
              <h4 data-magellan-destination="references" class="cheaders">10. References</h4>
              <hr class="chr">
              <blockquote>References: 
                <ul>
                  <li>Bibliography: Msdn.microsoft.com, (2014). ASP.NET MVC Overview. [online] Available at: http://msdn.microsoft.com/en-us/library/dd381412%28v=vs.108%29.aspx </li>
                  <li>Bibliography: forms, B. (2014). Biggest advantage to using ASP.Net MVC vs web forms. [online] Stackoverflow.com. Available at: http://stackoverflow.com/questions/102558/biggest-advantage-to-using-asp-net-mvc-vs-web-forms</li>
                  <li>Pro ASP.NET MVC 4 (Professional Apress) 4th. Apress Berkely, CA, USA ©2013. ISBN:1430242361 9781430242369</li>
                  <li>Bibliography: The Official Microsoft ASP.NET Site, (2014). Creating an Entity Framework Data Model. [online] Available at: http://www.asp.net/mvc/overview/older-versions/getting-started-with-ef-5-using-mvc-4/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application</li> 
                  <li>Bibliography: The Official Microsoft ASP.NET Site, (2014). Part 4: Models and Data Access. [online] Available at: http://www.asp.net/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-4</li>
                  <li>Bibliography: ZURB, i. (2014). Getting Started | Foundation Docs. [online] Foundation.zurb.com. Available at: http://foundation.zurb.com/docs/ </li>
                  <li>Bibliography: Ami.responsivedesign.is, (2014). Am I Responsive?. [online] Available at: http://ami.responsivedesign.is/ </li>
                  <li>Bibliography: pattern, T. (2014). The Model-View-Controller architecture pattern from the Course ASP.NET MVC 4 Essential Training. [online] lynda.com. Available at: http://www.lynda.com/ASPNET-tutorials/Model-View-Controller-architecture-pattern/109762/120280-4.html </li>
                  <li>Bibliography: Strumpflohner, J. (2014). Posting JSON Data to an ASP.net MVC 3 Web Application. [online] Juristr.com. Available at: http://juristr.com/blog/2011/08/posting-json-data-to-aspnet-mvc-3-web/ </li>
                  <li>Bibliography: Api.highcharts.com, (2014). Highcharts API Reference. [online] Available at: http://api.highcharts.com/highcharts</li>
                  <li>Bibliography: jquery.org, j. (2014). jQuery API Documentation. [online] Api.jquery.com. Available at: http://api.jquery.com/</li>
                  <li>Ciliberti J. ASP.NET MVC 4 Recipes. Apress</li>
                  <li>Palermo J., et al. ASP.NET MVC 4 IN ACTION.  [online] Available at: http://www.manning.com/palermo3/ASPMVC4samplech4.pdf</li>
                </ul>
              <blockquote>
          </div>
        </section>

        <footer class="large-12 columns cfooter">
            <div class="panel">
              <p class="pPanel">&copy; 2014 - Store Calls System Manuals</p>
            </div>
        </footer>
        <script src="js/jquery-1.7.1.js"></script>
        <script src="js/responsive-tables.js"></script>
        <script src="js/foundation.js"></script>
        <script src="js/foundation.topbar.js"></script>
        <script src="js/foundation.magellan.js"></script>
        <script src="js/custom.js"></script>
        <script>
            $(document).foundation();
        </script>
    </body>
</html>  